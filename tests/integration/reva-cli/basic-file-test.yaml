vars:
  REVANODE: "localhost:9142"
  TESTUSER: "testuser"
  TESTPASS: "testpass"

run:
  login:
    command: "cmd/reva/reva -insecure -host={{REVANODE}} -token-file=token login --username={{TESTUSER}} --password={{TESTPASS}} basic"
    expectCode: 0
  uploadFile:
    prerequisiteCwd: .
    prerequisites:
      - 'echo "Hello World" > local-test-file.txt'
    command:  'cmd/reva/reva -insecure -host={{REVANODE}} -token-file=token upload local-test-file.txt  /localfs/my-test-file.txt'
    expectCode: 0

  checkFile:
    command: 'cmd/reva/reva -insecure -host={{REVANODE}} ls /localfs'
    expectCode: 0
    outputContains:
    - 'my-test-file.txt'

  cleanupFile:
    command: 'cmd/reva/reva -insecure -host={{REVANODE}} rm  /localfs/my-test-file.txt'
    expectCode: 0
