# This storage-home.toml config file will start a reva service that:
[shared]
jwt_secret = "Pive-Fumkiu4"
gatewaysvc = "localhost:19000"

#[[registry.services.storagehome]]
#name = 'storage-home'
#
#[[registry.services.storagehome.nodes]]
#id = '130e0018-9e86-11eb-8634-336624ad2203'
#address = '0.0.0.0:9154'

# - authenticates grpc storage provider requests using the internal jwt token
# - authenticates http upload and download requests requests using basic auth
# - serves the home storage provider on grpc port 12000
# - serves http dataprovider for this storage on port 12001
#   - /data - dataprovider: file up and download
#
# The home storage will inject the username into the path and jail users into
# their home directory

[grpc]
address = "0.0.0.0:12000"

# This is a storage provider that grants direct access to the wrapped storage
# TODO same storage id as the /oc/ storage provider
# if we have an id, we can directly go to that storage, no need to wrap paths
# we have a locally running dataprovider
# this is where clients can find it
# the context path wrapper reads tho username from the context and prefixes the relative storage path with it
[grpc.services.storageprovider]
driver = "ocis"
mount_path = "/home"
mount_id = "123e4567-e89b-12d3-a456-426655440000"
expose_data_server = true
data_server_url = "http://revad-services:12001/data"
enable_home_creation = true

[grpc.services.storageprovider.drivers.ocis]
root = "/drone/src/tmp/reva/data"
enable_home = true
treetime_accounting = true
treesize_accounting = true


[http]
address = "0.0.0.0:12001"

[http.services.dataprovider]
driver = "ocis"
temp_folder = "/drone/src/tmp/reva/tmp"

[http.services.dataprovider.drivers.ocis]
root = "/drone/src/tmp/reva/data"
enable_home = true
treetime_accounting = true
treesize_accounting = true
